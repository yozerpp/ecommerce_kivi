@model Ecommerce.WebImpl.Pages.Shared._InfoPartial


<div
    class="alert  info-alert @(Model.Redirect != null ? "loading" : "") shadow-lg  alert-@(Model.Link != null ? "white" : Model.Success ? "success" : "danger") alert-dismissible fade show mt-3"
    role="alert"
    hx-swap="outerHTML"
    hx-target="this"
    hx-include="this">
    <style>
    .info-alert {
        @if (Model.Link != null){
            <text>cursor: pointer;</text>
        }
        border: none;
        border-radius: 12px;
        backdrop-filter: blur(10px);
        animation: slideInDown 0.4s ease-out;
        position: relative;
        overflow: hidden;
    }
    
    .loading::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, 
            @(Model.Success ? "#28a745, #20c997" : "#dc3545, #fd7e14"));
        animation: shimmer 2s infinite;
    }
    
    .info-alert.alert-success {
        background: linear-gradient(135deg, rgba(40, 167, 69, 0.1), rgba(32, 201, 151, 0.1));
        border-right: 4px solid #28a745;
        color: #155724;
    }
    
    .info-alert.alert-danger {
        background: linear-gradient(135deg, rgba(220, 53, 69, 0.1), rgba(253, 126, 20, 0.1));
        border-right: 4px solid #dc3545;
        color: #721c24;
    }
    
    .info-icon {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 14px;
        margin-right: 12px;
        flex-shrink: 0;
    }
    
    .info-icon.success {
        background: #28a745;
        color: white;
    }
    
    .info-icon.danger {
        background: #dc3545;
        color: white;
    }
    
    .loading-spinner {
        width: 20px;
        height: 20px;
        border: 2px solid #f3f3f3;
        border-top: 2px solid #007bff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-right: 8px;
    }
    
    .info-content {
        flex: 1;
    }
    
    .info-title {
        font-weight: 600;
        margin-bottom: 4px;
        font-size: 0.95rem;
    }
    
    .info-message {
        margin: 0;
        font-size: 0.875rem;
        line-height: 1.4;
    }
    
    .info-close {
        background: none;
        border: none;
        font-size: 1.2rem;
        opacity: 0.6;
        transition: opacity 0.2s;
        padding: 4px;
        border-radius: 4px;
    }
    
    .info-close:hover {
        opacity: 1;
        background: rgba(0,0,0,0.1);
    }
    
    @@keyframes slideInDown {
        from {
            transform: translateY(-100%);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }
    
    @@keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }
    
    @@keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .fade-out {
        animation: fadeOut 0.3s ease-out forwards;
    }
    
    @@keyframes fadeOut {
        to {
            opacity: 0;
            transform: translateY(-20px);
        }
    }
</style>
    <script>
        ((s)=>{
            document.addEventListener('DOMContentLoaded', load);
            s.parentElement.addEventListener('htmx:load', load);
            function load(e){
                if(e.type==='htmx:load') e.stopPropagation();
                @if (Model.Redirect != null){

                    if (Model.Redirect == "refresh"){
                        <text>
                setTimeout(() => window.location.reload(), @Model.TimeOut + 1);
                </text>
                    }
                    else{
                        <text>
                setTimeout(()=>window.location.href='@Model.Redirect', @(Model.TimeOut + 1)) ;
                </text>
                    }

                }
                else if (Model.Link != null){
                    <text>
                    s.parentElement.style.cursor='pointer';
                    s.parentElement.classList.add('hover-underline');
                    s.parentElement.addEventListener('click', _=>{
                        window.location.href = '@Model.Link';
                    });
                    @{ var tout = Model.TimeOut != 3000 ? Model.TimeOut : 10000; }
                    setTimeout(()=>s.parentElement.classList.add('fade-out'),@(tout - 300));
                    setTimeout(()=>s.parentElement.remove(),@(tout));
                </text>
                }
                else{
                    <text>
                    setTimeout(()=>s.parentElement.classList.add('fade-out'), @(Model.TimeOut != 0 ? Model.TimeOut - 300 : 1700));
                    setTimeout(() => s.parentElement.remove(), @(Model.TimeOut != 0 ? Model.TimeOut : 2000));
                </text>
                }
                console.log('initialized @(nameof(_InfoPartial)) from ' + e.type );
            }
        })(document.currentScript)
        //# sourceURL=_InfoPartial.js
    </script>
    <div class="d-flex align-items-start p-3">
        @if (Model.Link != null){
            <div class="bi bi-bell-fill fs-4 me-2 text-warning"></div>
        }
        else{
            <div class="info-icon @(Model.Success ? "success" : "danger")">
                @if (Model.Success){
                    <span>✓</span>
                }
                else{
                    <span>!</span>
                }
            </div>
        }
        
        <div class="info-content">
            @if (Model.Title != null){
                <div class="info-title @(Model.Link!=null?"text-danger-emphasis":"")">@Model.Title</div>
            }
            <div class="info-message">@Model.Message</div>
            @if (Model.Redirect != null){
                <div class="d-flex align-items-center"><div class="loading-spinner"></div><span>Yükleniyor...</span></div>

                @* <div class="w-100 d-inline-flex justify-content-end align-items-center align-content-center text-muted py-1 px-2" style="font-size: smaller"> *@
                @*     Yükleniyor... *@
                @* </div> *@
            }
        </div>

        <button type="button" class="info-close" data-bs-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
</div>
