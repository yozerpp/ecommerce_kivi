@model Ecommerce.WebImpl.Pages.Shared.Product._AddToCartButtonPartial

<form class="add-to-cart-btn" hx-post="/Cart" hx-target="#popupResult" hx-swap="innerHTML">
    <style>
        .add-to-cart-btn {
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }
        .add-to-cart-btn.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        .add-to-cart-form {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(8px);
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 140, 0, 0.2);
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            margin: 8px;
        }
        .quantity-input {
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 8px 12px;
            text-align: center;
            font-size: 14px;
            width: 80px;
        }
        .quantity-input:focus {
            outline: none;
            border-color: #ff8c00;
            box-shadow: 0 0 0 2px rgba(255, 140, 0, 0.2);
        }
        .add-cart-btn {
            background: linear-gradient(135deg, #ff8c00 0%, #ff7700 100%);
            border: none;
            border-radius: 6px;
            color: white;
            font-weight: 600;
            padding: 10px 20px;
            transition: all 0.2s ease;
            flex: 1;
        }
        .add-cart-btn:hover {
            background: linear-gradient(135deg, #ff7700 0%, #ff6600 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(255, 140, 0, 0.3);
        }
    </style>
    
    <script>
        ((s)=>{
            const parent = s.parentElement;
            document.addEventListener('DOMContentLoaded', load);
            parent.addEventListener('htmx:load', load);
            function load(e){
                if(e.type ==='htmx:load') e.stopPropagation();
                const i = parent.querySelector('input[type="number"]');
                parent.addEventListener('htmx:afterRequest', e=>{
                    if(!e.detail.successful) return;
                    document.dispatchEvent(new CartChangedEvent(parseInt(i.value),null,@Model.ProductId, true))
                })
            }
        })(document.currentScript)
        //# sourceURL=Index/@(nameof(_AddToCartButtonPartial)).js
    </script>
    
    @Html.AntiForgeryToken()
    <input type="hidden" name="productId" value="@Model.ProductId"/>
    <input type="hidden" name="sellerId" value="null"/>
    
    <div class="add-to-cart-form">
        <div class="d-flex align-items-center gap-3">
            <input type="number" 
                   class="quantity-input" 
                   min="1" 
                   name="quantity" 
                   step="1" 
                   value="1"
                   placeholder="1"/>
            <button type="submit" class="add-cart-btn">
                Sepete Ekle
            </button>
        </div>
    </div>
</form>
