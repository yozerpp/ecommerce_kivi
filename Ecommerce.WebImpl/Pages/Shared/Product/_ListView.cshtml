@using Ecommerce.Entity
@model Ecommerce.WebImpl.Pages.Shared.Product._ListView

<ul class="list-group bg-light">
    <li class="list-group-item py-2 px-0 bg-primary text-white">
        <ul class="list-group-horizontal row p-0">
            <li class="col-3 list-group-item d-flex p-0 px-0 align-items-center justify-content-center bg-primary text-white border-0">
                <p class="fs-6 fw-bold mb-0">Resim</p>
            </li>
            <li class="d-flex list-group-item justify-content-center col-2 p-0 align-items-center bg-primary text-white border-0">
                <p class="fs-6 fw-bold mb-0">Ürün Adı</p>
            </li>
            <li class="col-2 d-flex position-relative align-items-center align-content-center justify-content-center text-center list-group-item bg-primary text-white border-0">
                <p class="fs-6 fw-bold mb-0">Kategori</p>
            </li>
            <li class="col-2 list-group-item position-relative bg-primary text-white border-0">
                <p class="fs-6 fw-bold mb-0">Satış Sayısı</p>
            </li>
            <li class="col-3 text-center position-relative d-inline-flex flex-column align-items-center justify-content-center align-content-center list-group-item bg-primary text-white border-0">
                <p class="fs-6 fw-bold mb-0">Değerlendirme</p>
            </li>
        </ul>
    </li>
    @foreach (var Product in Model.Products){
        <li data-id="@Product.Id" onclick="event.currentTarget.parentElement._selected?.classList.remove('bg-secondary-subtle');event.currentTarget.classList.add('bg-secondary-subtle');event.currentTarget.parentElement._selected = event.currentTarget" class="hover-darken-2 list-group-item py-0 px-0">
            <ul class="list-group-horizontal row p-0">
                <li class="col-3 list-group-item d-flex p-0 px-0 align-items-center-center justify-content-center">
                    @{
                        var data = Product.MainImage?.Data;
                        data = !string.IsNullOrEmpty(data) ? (data.StartsWith("data:") ? data : ("data:image/jpeg;base64," + data)) : "/default.jpg";
                    }
                    <img src="@(data)" class="img-fluid rounded-0 flex-fill" style="max-height: 7em;" alt="Image of @Product.Name"/>
                </li>
                <li class="d-flex list-group-item justify-content-center col-2 p-0 align-items-center">
                    <p class="fs-4 fw-bold">@(Product.Name)</p>
                </li>
                <li style="text-wrap: wrap; word-wrap: break-word;" class="col-2 d-flex position-relative align-items-center align-content-center justify-content-center text-center list-group-item text-wrap">
                    <p class="fs-5">@((ViewBag.Categories[Product.CategoryId] as Category)?.Name)</p>
                </li>
                <li class="col-2 list-group-item position-relative">
                    <p class="fs-6">@(Product.Stats.OrderCount) Kez Satıldı</p>
                </li>
                <li style="text-wrap: wrap; word-wrap: break-word" class="col-3 text-center position-relative d-inline-flex flex-column align-items-center justify-content-center align-content-center overflow-x-hidden list-group-item text-nowrap">
                    @await Html.PartialAsync("Shared/_ReviewStarPartial", new _ReviewStarPartial(){
                        Rating = Product.Stats.RatingAverage.Value,
                        RatingCount = (int)Product.Stats.ReviewCount.Value
                    })
                </li>
            </ul>
        </li>
    }
</ul>
